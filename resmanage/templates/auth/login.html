{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v4.0.1">
    <link rel="shortcut icon" href="{%static 'images/sd1.png'%}" type="image/x-icon">
    <title>登录-预约管理</title>
    <link rel="stylesheet" href="{% static 'css/bootstrap-5.3.0/bootstrap.min.css' %}">
    <!-- Custom styles for this template -->
    <link href="{%static 'css/album.css'%}css/album.css" rel="stylesheet">
    <link href="{%static 'css/pricing.css'%}" rel="stylesheet">

    <!-- Bootstrap core CSS -->
    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        @media(min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }
    </style>
    <!-- Custom styles for this template -->
    <link href="{%static 'css/floating-labels.css'%}" rel="stylesheet">
</head>

<body>
    <script src="{%static 'js/jquery-3.3.1.min.js'%}"></script>
    <script src="{%static 'js/bootstrap-5.3.0/bootstrap.bundle.js'%}"></script>
    <script type="text/javascript" src="{%static 'js/bootstrapValidator.min.js'%}"></script>

    <form class="form-signin" action="{%url 'login'%}" method="post">
        {% csrf_token %}
        <div class="text-center mb-1">
            <img class="mb-4 img" src="{%static 'images/sd0.png'%}" alt="" height="152">
            <h1 class="h2 mb-3 font-weight-normal"><strong>欢迎！</strong></h1>
            <p><small>门禁通过预约申请需要注册后提交，若您是公司内部管理人员，则需要向管理员申请员工账户。</small></p>
            <p><small>若还没有账号，请<a class="tce" href="{%url 'registerAction'%}">前往注册</a></small></p>
        </div>

        <div class="form-label-group">
            <input type="text" name="username" id="inputText" class="form-control" placeholder="Username" required
                autofocus minlength="3" maxlength="10">
            <label for="inputText">用户名</label>
        </div>

        <div class="form-label-group">
            <input type="password" name="password" id="inputPassword" class="form-control" placeholder="Password"
                required minlength="8" maxlength="16">
            <label for="inputPassword">密码</label>
        </div>
        <div class="mb-3 form-check rem">
            <input type="checkbox" class="form-check-input" id="exampleCheck1">
            <label class="form-check-label" for="exampleCheck1">记住密码</label>
        </div>
        <div class="form-group">
            <button class="btn btn-lg btn-primary btn-block" type="submit" onclick="fn()">登录</button>
        </div>
        <p class="mt-3 mb-3 text-muted text-center"><small>若忘记账户密码，请<a class="tce"
                    href="#">前往验证</a>，或联系管理员：kwkz19171010@gmail.com</small></p>
        <p class="mt-3 mb-3 text-muted text-center">© 2024 @MyonKu</p>
    </form>


    <script type="text/javascript">
        var user = document.getElementById('inputText'),
            pass = document.getElementById('inputPassword'),
            check = document.getElementById('exampleCheck1'),
            localUser = localStorage.getItem('user') || ''; //获取到user的值并保存
        localPass = localStorage.getItem('pass') || ''; //获取到pwd的值并保存
        user.value = localUser;
        pass.value = localPass;
        if (localUser !== '' && localPass !== '') {
            check.setAttribute('checked', '');
        }

        function fn() {
            if (check.checked) {
                localStorage.setItem('user', user.value);
                localStorage.setItem('pass', pass.value);
            } else {
                localStorage.setItem('user', '');
                localStorage.setItem('pass', '');
            }
        }
    </script>
    {% if messages %}
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <img src="{% static 'images/sd1.png' %}" width="22" height="22" class="rounded me-2" alt="...">
                <strong class="me-auto">系统提示</strong>
                <small class="text-body-secondary"></small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body text-center">
                {% for msg in messages %}
                    {{ msg.message }}
                {% endfor %}
            </div>
        </div>
    </div>
    <script>
        
        const toastLiveExample = document.getElementById('liveToast');
        const toastBootstrap = bootstrap.Toast.getOrCreateInstance(toastLiveExample);
        {% for msg in messages %}
            if('{{ msg.message }}' != ""){
                time = new Date().toLocaleTimeString('chinese', { hour12: true });
                var small = document.querySelector('.text-body-secondary');
                small.innerHTML = time;
                toastBootstrap.show();
            }
        {% endfor %}
        
    </script>
    {% endif %}
    
</body>

</html>